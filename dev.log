nohup: ignoring input

> ubva-ia@0.1.0 dev
> node dev-fast.js

üöÄ Starting dev server...
[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
üöÄ Next.js rodando em http://0.0.0.0:3000
üì° WebSocket dispon√≠vel em ws://0.0.0.0:3000/ws
 ‚óã Compiling / ...
 GET / 200 in 25.1s (compile: 21.6s, render: 3.5s)
 GET / 200 in 26.4s (compile: 23.5s, render: 2.9s)
 GET / 200 in 80s (compile: 78s, render: 2.5s)
üîå WebSocket upgrade request: {
  pathname: '/_next/webpack-hmr',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚ö†Ô∏è  Path n√£o √© /ws, ignorando: /_next/webpack-hmr
üîå WebSocket upgrade request: {
  pathname: '/ws',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚úÖ Aceitando conex√£o WebSocket em /ws
‚úÖ Novo cliente WebSocket conectado
üì® Broadcasting mensagem: message
 ‚óã Compiling /api/session ...
 GET /api/webhook-config 200 in 3.3s (compile: 2.9s, proxy.ts: 30ms, render: 391ms)
 GET /api/webhook-config 200 in 99ms (compile: 23ms, proxy.ts: 32ms, render: 45ms)
POST /api/message payload: {"sessionId":"e06950ce-074f-41ab-b7f0-13d30f502ef6","role":"user","content":"Sugira os melhores tipos de vidro para projetos arquitet√¥nicos","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 POST /api/session 200 in 10.0s (compile: 8.8s, proxy.ts: 525ms, render: 680ms)
‚úÖ PostgreSQL tables initialized
 POST /api/session 200 in 10.2s (compile: 9.0s, proxy.ts: 459ms, render: 767ms)
 POST /api/session 200 in 9.3s (compile: 8.6s, proxy.ts: 40ms, render: 584ms)
Saved message for session e06950ce-074f-41ab-b7f0-13d30f502ef6: {
  id: 'ce77862f-e24c-48a3-a089-c3ada31881a2',
  session_id: 'e06950ce-074f-41ab-b7f0-13d30f502ef6',
  role: 'user',
  content: 'Sugira os melhores tipos de vidro para projetos arquitet√¥nicos',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:16:49.478Z,
  imageUrl: undefined
}
 POST /api/message 200 in 9.4s (compile: 8.1s, proxy.ts: 33ms, render: 1293ms)
 ‚óã Compiling /admin/dashboard ...
 GET /admin/dashboard 200 in 11.9s (compile: 10.8s, render: 1065ms)
üîå WebSocket upgrade request: {
  pathname: '/_next/webpack-hmr',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚ö†Ô∏è  Path n√£o √© /ws, ignorando: /_next/webpack-hmr
üîå WebSocket upgrade request: {
  pathname: '/ws',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚úÖ Aceitando conex√£o WebSocket em /ws
‚úÖ Novo cliente WebSocket conectado
 GET /admin 200 in 1384ms (compile: 1234ms, render: 150ms)
‚ùå Cliente WebSocket desconectado
 GET /admin/dashboard 200 in 141ms (compile: 17ms, render: 124ms)
 GET /api/session/dates 200 in 1678ms (compile: 1478ms, proxy.ts: 56ms, render: 144ms)
 GET /api/session/dates 200 in 140ms (compile: 28ms, proxy.ts: 54ms, render: 58ms)
üîå WebSocket upgrade request: {
  pathname: '/ws',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚úÖ Aceitando conex√£o WebSocket em /ws
‚úÖ Novo cliente WebSocket conectado
 GET /api/session/summary 200 in 9.6s (compile: 1938ms, proxy.ts: 27ms, render: 7.6s)
 GET /api/webhook-config 200 in 172ms (compile: 12ms, proxy.ts: 18ms, render: 142ms)
 GET /api/webhook-config 200 in 114ms (compile: 33ms, proxy.ts: 28ms, render: 53ms)
 POST /api/webhook-config 200 in 173ms (compile: 18ms, proxy.ts: 21ms, render: 134ms)
 POST /api/webhook-config 200 in 90ms (compile: 19ms, proxy.ts: 27ms, render: 44ms)
 POST /api/session 200 in 222ms (compile: 29ms, proxy.ts: 15ms, render: 178ms)
Error saving session via Drizzle: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: 9f08101b-1fd8-4896-a970-259c4282c223,Sess√£o 9f08101b-1fd8-4896-a970-259c4282c223,Rogger,41991747318
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(9f08101b-1fd8-4896-a970-259c4282c223) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
Error in /api/session: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: 9f08101b-1fd8-4896-a970-259c4282c223,Sess√£o 9f08101b-1fd8-4896-a970-259c4282c223,Rogger,41991747318
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(9f08101b-1fd8-4896-a970-259c4282c223) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
 POST /api/session 500 in 1614ms (compile: 31ms, proxy.ts: 54ms, render: 1530ms)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"9f08101b-1fd8-4896-a970-259c4282c223","role":"user","content":"Sugira os melhores tipos de vidro para projetos arquitet√¥nicos","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 GET /api/webhook-config 200 in 211ms (compile: 39ms, proxy.ts: 33ms, render: 139ms)
Saved message for session 9f08101b-1fd8-4896-a970-259c4282c223: {
  id: '9d214481-c36c-4889-a3a6-b16bbed966b8',
  session_id: '9f08101b-1fd8-4896-a970-259c4282c223',
  role: 'user',
  content: 'Sugira os melhores tipos de vidro para projetos arquitet√¥nicos',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:18:32.316Z,
  imageUrl: undefined
}
 POST /api/message 200 in 325ms (compile: 119ms, proxy.ts: 28ms, render: 178ms)
 GET /api/webhook-config 200 in 100ms (compile: 12ms, proxy.ts: 65ms, render: 23ms)
 POST /api/session 200 in 418ms (compile: 72ms, proxy.ts: 108ms, render: 239ms)
 GET /api/session/e06950ce-074f-41ab-b7f0-13d30f502ef6/messages 200 in 4.7s (compile: 4.4s, proxy.ts: 10ms, render: 282ms)
 GET /api/session/0b076a8e-b571-4c1f-9631-08878f1d87d3/messages 200 in 1179ms (compile: 587ms, proxy.ts: 68ms, render: 524ms)
‚úÖ PostgreSQL tables initialized
 GET /api/session/dates 200 in 844ms (compile: 58ms, proxy.ts: 65ms, render: 721ms)
 GET /api/session/summary 200 in 9.6s (compile: 60ms, proxy.ts: 54ms, render: 9.5s)
 ‚úì Compiled in 3ms
 POST /api/webhook-proxy 200 in 2.8s (compile: 1594ms, proxy.ts: 50ms, render: 1201ms)
 GET / 200 in 1810ms (compile: 317ms, render: 1493ms)
üîå WebSocket upgrade request: {
  pathname: '/_next/webpack-hmr',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚ö†Ô∏è  Path n√£o √© /ws, ignorando: /_next/webpack-hmr
 POST /api/session 200 in 446ms (compile: 70ms, proxy.ts: 98ms, render: 278ms)
üîå WebSocket upgrade request: {
  pathname: '/ws',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚úÖ Aceitando conex√£o WebSocket em /ws
‚úÖ Novo cliente WebSocket conectado
 POST /api/session 200 in 451ms (compile: 270ms, proxy.ts: 51ms, render: 130ms)
Error saving session via Drizzle: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: 67d733eb-0d49-4135-b7ba-2535472bfa06,Sess√£o 67d733eb-0d49-4135-b7ba-2535472bfa06,Rogger,41991747318
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(67d733eb-0d49-4135-b7ba-2535472bfa06) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
Error in /api/session: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: 67d733eb-0d49-4135-b7ba-2535472bfa06,Sess√£o 67d733eb-0d49-4135-b7ba-2535472bfa06,Rogger,41991747318
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(67d733eb-0d49-4135-b7ba-2535472bfa06) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
 POST /api/session 500 in 943ms (compile: 35ms, proxy.ts: 27ms, render: 882ms)
 POST /api/session 200 in 961ms (compile: 27ms, proxy.ts: 19ms, render: 915ms)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"67d733eb-0d49-4135-b7ba-2535472bfa06","role":"user","content":"Sugira os melhores tipos de vidro para projetos arquitet√¥nicos","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 GET /api/webhook-config 200 in 155ms (compile: 67ms, proxy.ts: 34ms, render: 55ms)
Saved message for session 67d733eb-0d49-4135-b7ba-2535472bfa06: {
  id: '9baf9317-40dd-42fd-89fc-d19e1d3f1527',
  session_id: '67d733eb-0d49-4135-b7ba-2535472bfa06',
  role: 'user',
  content: 'Sugira os melhores tipos de vidro para projetos arquitet√¥nicos',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:21:39.600Z,
  imageUrl: undefined
}
 POST /api/message 200 in 276ms (compile: 50ms, proxy.ts: 33ms, render: 192ms)
 GET /api/webhook-config 200 in 133ms (compile: 63ms, proxy.ts: 42ms, render: 28ms)
 POST /api/session 200 in 387ms (compile: 80ms, proxy.ts: 35ms, render: 271ms)
 POST /api/session 200 in 392ms (compile: 35ms, proxy.ts: 91ms, render: 265ms)
 POST /api/webhook-proxy 200 in 529ms (compile: 11ms, proxy.ts: 13ms, render: 505ms)
 GET / 200 in 971ms (compile: 21ms, render: 950ms)
üîå WebSocket upgrade request: {
  pathname: '/_next/webpack-hmr',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚ö†Ô∏è  Path n√£o √© /ws, ignorando: /_next/webpack-hmr
 POST /api/session 200 in 118ms (compile: 12ms, proxy.ts: 13ms, render: 92ms)
 POST /api/session 200 in 147ms (compile: 11ms, proxy.ts: 28ms, render: 108ms)
üîå WebSocket upgrade request: {
  pathname: '/ws',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚úÖ Aceitando conex√£o WebSocket em /ws
‚úÖ Novo cliente WebSocket conectado
 POST /api/session 200 in 204ms (compile: 40ms, proxy.ts: 41ms, render: 123ms)
 POST /api/session 200 in 326ms (compile: 69ms, proxy.ts: 40ms, render: 218ms)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"c514ef18-87f9-49f4-92ac-fda4c8e75ff2","role":"user","content":"Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 GET /api/webhook-config 200 in 559ms (compile: 213ms, proxy.ts: 126ms, render: 221ms)
 POST /api/session 200 in 616ms (compile: 184ms, proxy.ts: 182ms, render: 250ms)
Saved message for session c514ef18-87f9-49f4-92ac-fda4c8e75ff2: {
  id: '7ce29847-688d-4dc9-9a10-bae986339bde',
  session_id: 'c514ef18-87f9-49f4-92ac-fda4c8e75ff2',
  role: 'user',
  content: 'Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:21:56.076Z,
  imageUrl: undefined
}
 POST /api/message 200 in 706ms (compile: 198ms, proxy.ts: 123ms, render: 385ms)
 GET /api/webhook-config 200 in 257ms (compile: 106ms, proxy.ts: 92ms, render: 59ms)
 POST /api/session 200 in 906ms (compile: 202ms, proxy.ts: 175ms, render: 529ms)
 POST /api/session 200 in 859ms (compile: 217ms, proxy.ts: 134ms, render: 508ms)
   Reload env: .env
 ‚óã Compiling /_not-found/page ...
 GET /admin/dashboard 404 in 13.6s (compile: 10.1s, render: 3.5s)
 GET / 404 in 13.5s (compile: 11.0s, render: 2.4s)
 GET /admin/dashboard 200 in 1689ms (compile: 516ms, render: 1173ms)
 GET / 200 in 1102ms (compile: 376ms, render: 726ms)
 GET / 200 in 525ms (compile: 14ms, render: 512ms)
 GET /admin/dashboard 200 in 422ms (compile: 18ms, render: 404ms)
 GET / 200 in 242ms (compile: 12ms, render: 230ms)
 GET / 200 in 150ms (compile: 8ms, render: 141ms)
 GET / 200 in 464ms (compile: 14ms, render: 450ms)
 GET /admin/dashboard 200 in 464ms (compile: 97ms, render: 368ms)
 GET / 200 in 278ms (compile: 13ms, render: 265ms)
 GET / 200 in 203ms (compile: 17ms, render: 187ms)
üì® Broadcasting mensagem: message
 GET / 200 in 1529ms (compile: 20ms, render: 1509ms)
 GET /admin/dashboard 200 in 1538ms (compile: 97ms, render: 1441ms)
 GET / 200 in 1412ms (compile: 16ms, render: 1396ms)
 GET / 200 in 1797ms (compile: 19ms, render: 1778ms)
POST /api/message payload: {"sessionId":"0219e404-63d7-410e-8003-ab247231a6f2","role":"user","content":"Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 POST /api/session 200 in 2.6s (compile: 518ms, proxy.ts: 260ms, render: 1801ms)
Error saving session via Drizzle: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: 0219e404-63d7-410e-8003-ab247231a6f2,Sess√£o 0219e404-63d7-410e-8003-ab247231a6f2,Rogger,41991747318
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(0219e404-63d7-410e-8003-ab247231a6f2) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
Error in /api/session: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: 0219e404-63d7-410e-8003-ab247231a6f2,Sess√£o 0219e404-63d7-410e-8003-ab247231a6f2,Rogger,41991747318
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(0219e404-63d7-410e-8003-ab247231a6f2) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
 POST /api/session 500 in 3.4s (compile: 640ms, proxy.ts: 263ms, render: 2.5s)
‚úÖ PostgreSQL tables initialized
 GET / 200 in 3.3s (compile: 48ms, render: 3.3s)
 POST /api/session 200 in 844ms (compile: 137ms, proxy.ts: 470ms, render: 237ms)
 POST /api/session 200 in 858ms (compile: 177ms, proxy.ts: 477ms, render: 204ms)
 GET /admin/dashboard 200 in 3.2s (compile: 43ms, render: 3.1s)
 GET /api/webhook-config 200 in 5.3s (compile: 462ms, proxy.ts: 1488ms, render: 3.4s)
Saved message for session 0219e404-63d7-410e-8003-ab247231a6f2: {
  id: '2732f783-b9b1-46b8-9b31-a449862ecaa1',
  session_id: '0219e404-63d7-410e-8003-ab247231a6f2',
  role: 'user',
  content: 'Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:22:55.424Z,
  imageUrl: undefined
}
 POST /api/message 200 in 6.1s (compile: 688ms, proxy.ts: 517ms, render: 4.9s)
 POST /api/session 200 in 3.3s (compile: 284ms, proxy.ts: 2.5s, render: 479ms)
 GET / 200 in 3.5s (compile: 2.2s, render: 1322ms)
 GET /api/webhook-config 200 in 216ms (compile: 36ms, proxy.ts: 38ms, render: 141ms)
 GET /admin/dashboard 200 in 3.6s (compile: 75ms, render: 3.5s)
 GET / 200 in 603ms (compile: 85ms, render: 518ms)
 GET / 200 in 479ms (compile: 53ms, render: 426ms)
 GET / 200 in 1025ms (compile: 39ms, render: 986ms)
 GET / 200 in 1139ms (compile: 97ms, render: 1043ms)
 GET / 200 in 1213ms (compile: 27ms, render: 1186ms)
 GET / 200 in 635ms (compile: 42ms, render: 593ms)
üîå WebSocket upgrade request: {
  pathname: '/_next/webpack-hmr',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚ö†Ô∏è  Path n√£o √© /ws, ignorando: /_next/webpack-hmr
üîå WebSocket upgrade request: {
  pathname: '/_next/webpack-hmr',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚ö†Ô∏è  Path n√£o √© /ws, ignorando: /_next/webpack-hmr
üîå WebSocket upgrade request: {
  pathname: '/ws',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚úÖ Aceitando conex√£o WebSocket em /ws
‚úÖ Novo cliente WebSocket conectado
 POST /api/session 200 in 640ms (compile: 157ms, proxy.ts: 283ms, render: 201ms)
 POST /api/session 200 in 710ms (compile: 312ms, proxy.ts: 228ms, render: 170ms)
 GET /api/session/dates 200 in 691ms (compile: 486ms, proxy.ts: 112ms, render: 93ms)
üîå WebSocket upgrade request: {
  pathname: '/ws',
  host: 'localhost:3000',
  origin: 'http://localhost:3000'
}
‚úÖ Aceitando conex√£o WebSocket em /ws
‚úÖ Novo cliente WebSocket conectado
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"fb051f27-c88d-4b36-a38a-359ba9c9b370","role":"user","content":"Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 GET /api/webhook-config 200 in 659ms (compile: 211ms, proxy.ts: 243ms, render: 205ms)
 GET /api/session/summary 200 in 10.5s (compile: 776ms, proxy.ts: 112ms, render: 9.6s)
 POST /api/session 200 in 8.0s (compile: 374ms, proxy.ts: 183ms, render: 7.4s)
Error saving session via Drizzle: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: fb051f27-c88d-4b36-a38a-359ba9c9b370,Sess√£o 55,,
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(fb051f27-c88d-4b36-a38a-359ba9c9b370) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
Error in /api/session: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: fb051f27-c88d-4b36-a38a-359ba9c9b370,Sess√£o 55,,
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(fb051f27-c88d-4b36-a38a-359ba9c9b370) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
 POST /api/session 500 in 8.6s (compile: 259ms, proxy.ts: 178ms, render: 8.1s)
Error saving message via Drizzle: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, default, default, default)
params: fb051f27-c88d-4b36-a38a-359ba9c9b370,Sess√£o fb051f27-c88d-4b36-a38a-359ba9c9b370
    at async saveMessage (file:/srv/sites/ubvaia/lib/session-api.ts:52:7)
    at async POST (file:/srv/sites/ubvaia/app/api/message/route.ts:13:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  50 |     const existing = await db.select().from(sessions).where(eq(sessions.id, sessionId));
  51 |     if (existing.length === 0) {
> 52 |       await db.insert(sessions).values({ id: sessionId, name: `Sess√£o ${sessionId}` });
     |       ^
  53 |     }
  54 |
  55 |     await db.insert(messages).values({ {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, default, default, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveMessage (file:/srv/sites/ubvaia/lib/session-api.ts:52:7)
      at async POST (file:/srv/sites/ubvaia/app/api/message/route.ts:13:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    50 |     const existing = await db.select().from(sessions).where(eq(sessions.id, sessionId));
    51 |     if (existing.length === 0) {
  > 52 |       await db.insert(sessions).values({ id: sessionId, name: `Sess√£o ${sessionId}` });
       |       ^
    53 |     }
    54 |
    55 |     await db.insert(messages).values({ {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(fb051f27-c88d-4b36-a38a-359ba9c9b370) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
Error in /api/message: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, default, default, default)
params: fb051f27-c88d-4b36-a38a-359ba9c9b370,Sess√£o fb051f27-c88d-4b36-a38a-359ba9c9b370
    at async saveMessage (file:/srv/sites/ubvaia/lib/session-api.ts:52:7)
    at async POST (file:/srv/sites/ubvaia/app/api/message/route.ts:13:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  50 |     const existing = await db.select().from(sessions).where(eq(sessions.id, sessionId));
  51 |     if (existing.length === 0) {
> 52 |       await db.insert(sessions).values({ id: sessionId, name: `Sess√£o ${sessionId}` });
     |       ^
  53 |     }
  54 |
  55 |     await db.insert(messages).values({ {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, default, default, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveMessage (file:/srv/sites/ubvaia/lib/session-api.ts:52:7)
      at async POST (file:/srv/sites/ubvaia/app/api/message/route.ts:13:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    50 |     const existing = await db.select().from(sessions).where(eq(sessions.id, sessionId));
    51 |     if (existing.length === 0) {
  > 52 |       await db.insert(sessions).values({ id: sessionId, name: `Sess√£o ${sessionId}` });
       |       ^
    53 |     }
    54 |
    55 |     await db.insert(messages).values({ {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(fb051f27-c88d-4b36-a38a-359ba9c9b370) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
 POST /api/message 500 in 9.1s (compile: 211ms, proxy.ts: 327ms, render: 8.6s)
Error saving session via Drizzle: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: fb051f27-c88d-4b36-a38a-359ba9c9b370,Sess√£o fb051f27-c88d-4b36-a38a-359ba9c9b370,Rogger,41991747318
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(fb051f27-c88d-4b36-a38a-359ba9c9b370) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
Error in /api/session: Error: Failed query: insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)
params: fb051f27-c88d-4b36-a38a-359ba9c9b370,Sess√£o fb051f27-c88d-4b36-a38a-359ba9c9b370,Rogger,41991747318
    at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
    at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
    at async Server.<anonymous> (server-custom.ts:36:13)
  86 |     if (existing.length === 0) {
  87 |       try {
> 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
     |         ^
  89 |       } catch (insertErr: any) {
  90 |         // Handle duplicate key by updating instead
  91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
  query: 'insert into "sessions" ("id", "name", "nome_completo", "remote_jid", "created_at") values ($1, $2, $3, $4, default)',
  params: [Array],
  [cause]: error: duplicate key value violates unique constraint "sessions_pkey"
      at async saveSession (file:/srv/sites/ubvaia/lib/session-api.ts:88:9)
      at async POST (file:/srv/sites/ubvaia/app/api/session/route.ts:25:5)
      at async Server.<anonymous> (server-custom.ts:36:13)
    86 |     if (existing.length === 0) {
    87 |       try {
  > 88 |         await db.insert(sessions).values({ id, name: name || null, nome_completo: nome_completo || null, remote_jid: remote_jid || null });
       |         ^
    89 |       } catch (insertErr: any) {
    90 |         // Handle duplicate key by updating instead
    91 |         if (insertErr?.message?.includes('duplicate') || insertErr?.code === '23505') { {
    length: 224,
    severity: 'ERROR',
    code: '23505',
    detail: 'Key (id)=(fb051f27-c88d-4b36-a38a-359ba9c9b370) already exists.',
    hint: undefined,
    position: undefined,
    internalPosition: undefined,
    internalQuery: undefined,
    where: undefined,
    schema: 'public',
    table: 'sessions',
    column: undefined,
    dataType: undefined,
    constraint: 'sessions_pkey',
    file: 'nbtinsert.c',
    line: '666',
    routine: '_bt_check_unique'
  }
}
 POST /api/session 500 in 8.3s (compile: 288ms, proxy.ts: 251ms, render: 7.7s)
 POST /api/session 200 in 7.1s (compile: 157ms, proxy.ts: 214ms, render: 6.7s)
 GET /api/webhook-config 200 in 122ms (compile: 67ms, proxy.ts: 23ms, render: 33ms)
 POST /api/session 200 in 211ms (compile: 46ms, proxy.ts: 83ms, render: 82ms)
 ‚úì Compiled in 8.9s
   Reload env: .env
 ‚úì Compiled in 1185ms
 GET / 200 in 1616ms (compile: 332ms, render: 1283ms)
 GET /admin/dashboard 200 in 975ms (compile: 746ms, render: 229ms)
 GET / 200 in 90ms (compile: 10ms, render: 79ms)
 GET / 200 in 280ms (compile: 10ms, render: 270ms)
 GET /admin/dashboard 200 in 213ms (compile: 14ms, render: 199ms)
 GET / 200 in 212ms (compile: 15ms, render: 198ms)
 GET / 200 in 300ms (compile: 15ms, render: 285ms)
 GET / 200 in 304ms (compile: 134ms, render: 170ms)
 GET /admin/dashboard 200 in 381ms (compile: 45ms, render: 336ms)
 GET / 200 in 168ms (compile: 10ms, render: 157ms)
 GET / 200 in 88ms (compile: 9ms, render: 79ms)
 GET / 200 in 292ms (compile: 27ms, render: 265ms)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"8df1514b-7047-4577-92c6-fefc86bdb80f","role":"user","content":"Explique como funciona o processo de manufatura de vidro plano e quais as suas principais aplica√ß√µes no mercado brasileiro?","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 POST /api/session 200 in 2.3s (compile: 420ms, proxy.ts: 446ms, render: 1426ms)
‚úÖ PostgreSQL tables initialized
 GET /api/webhook-config 200 in 1330ms (compile: 568ms, proxy.ts: 245ms, render: 517ms)
 POST /api/session 200 in 2.4s (compile: 666ms, proxy.ts: 442ms, render: 1296ms)
 POST /api/session 200 in 1363ms (compile: 572ms, proxy.ts: 253ms, render: 537ms)
Saved message for session 8df1514b-7047-4577-92c6-fefc86bdb80f: {
  id: 'cfc1bcac-d3e6-4ba7-b3c0-1ce666706485',
  session_id: '8df1514b-7047-4577-92c6-fefc86bdb80f',
  role: 'user',
  content: 'Explique como funciona o processo de manufatura de vidro plano e quais as suas principais aplica√ß√µes no mercado brasileiro?',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:24:00.063Z,
  imageUrl: undefined
}
 POST /api/message 200 in 1542ms (compile: 411ms, proxy.ts: 242ms, render: 889ms)
 POST /api/session 200 in 257ms (compile: 41ms, proxy.ts: 107ms, render: 109ms)
 GET /api/webhook-config 200 in 158ms (compile: 88ms, proxy.ts: 33ms, render: 37ms)
 POST /api/session 200 in 650ms (compile: 48ms, proxy.ts: 98ms, render: 504ms)
 GET /api/webhook-config 200 in 225ms (compile: 31ms, proxy.ts: 52ms, render: 142ms)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"8df1514b-7047-4577-92c6-fefc86bdb80f","role":"user","content":"√Åudio enviado","contentType":"audio","audioUrl":"blob:http://localhost:3000/fc2c8ea0-aba8-4cd6-b2a1-71435799aa0f","nome_completo":"Rogger","remote_jid":"41991747318"}
Saved message for session 8df1514b-7047-4577-92c6-fefc86bdb80f: {
  id: '475a9276-734c-43d5-ae54-3e612e006e58',
  session_id: '8df1514b-7047-4577-92c6-fefc86bdb80f',
  role: 'user',
  content: '√Åudio enviado',
  content_type: 'audio',
  image_url: null,
  audio_url: 'blob:http://localhost:3000/fc2c8ea0-aba8-4cd6-b2a1-71435799aa0f',
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:24:16.669Z,
  imageUrl: undefined
}
 POST /api/message 200 in 297ms (compile: 30ms, proxy.ts: 31ms, render: 236ms)
 POST /api/session 200 in 503ms (compile: 141ms, proxy.ts: 72ms, render: 290ms)
 GET /api/webhook-config 200 in 625ms (compile: 212ms, proxy.ts: 114ms, render: 299ms)
 POST /api/session 200 in 1039ms (compile: 238ms, proxy.ts: 176ms, render: 625ms)
 POST /api/session 200 in 1728ms (compile: 432ms, proxy.ts: 221ms, render: 1075ms)
Timeout ao comunicar com n8n: Error [AbortError]: This operation was aborted
    at async POST (file:/srv/sites/ubvaia/app/api/n8n-proxy/route.ts:44:13)
    at async Server.<anonymous> (server-custom.ts:36:13)
  42 |     let res;
  43 |     try {
> 44 |       res = await fetch(webhookUrl, {
     |             ^
  45 |         method: 'POST',
  46 |         headers: {
  47 |           'Content-Type': 'application/json', {
  code: 20,
  INDEX_SIZE_ERR: 1,
  DOMSTRING_SIZE_ERR: 2,
  HIERARCHY_REQUEST_ERR: 3,
  WRONG_DOCUMENT_ERR: 4,
  INVALID_CHARACTER_ERR: 5,
  NO_DATA_ALLOWED_ERR: 6,
  NO_MODIFICATION_ALLOWED_ERR: 7,
  NOT_FOUND_ERR: 8,
  NOT_SUPPORTED_ERR: 9,
  INUSE_ATTRIBUTE_ERR: 10,
  INVALID_STATE_ERR: 11,
  SYNTAX_ERR: 12,
  INVALID_MODIFICATION_ERR: 13,
  NAMESPACE_ERR: 14,
  INVALID_ACCESS_ERR: 15,
  VALIDATION_ERR: 16,
  TYPE_MISMATCH_ERR: 17,
  SECURITY_ERR: 18,
  NETWORK_ERR: 19,
  ABORT_ERR: 20,
  URL_MISMATCH_ERR: 21,
  QUOTA_EXCEEDED_ERR: 22,
  TIMEOUT_ERR: 23,
  INVALID_NODE_TYPE_ERR: 24,
  DATA_CLONE_ERR: 25
}
 POST /api/n8n-proxy 504 in 6.1s (compile: 2.7s, proxy.ts: 218ms, render: 3.2s)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"8df1514b-7047-4577-92c6-fefc86bdb80f","role":"assistant","content":"Timeout ao comunicar com n8n.","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 GET /api/webhook-config 200 in 95ms (compile: 36ms, proxy.ts: 21ms, render: 38ms)
Saved message for session 8df1514b-7047-4577-92c6-fefc86bdb80f: {
  id: '1a210ec5-af9a-4a9f-bbfc-25cd4157e7a1',
  session_id: '8df1514b-7047-4577-92c6-fefc86bdb80f',
  role: 'assistant',
  content: 'Timeout ao comunicar com n8n.',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:24:23.382Z,
  imageUrl: undefined
}
 POST /api/message 200 in 258ms (compile: 17ms, proxy.ts: 18ms, render: 222ms)
 POST /api/session 200 in 184ms (compile: 33ms, proxy.ts: 25ms, render: 126ms)
 POST /api/session 200 in 254ms (compile: 44ms, proxy.ts: 24ms, render: 186ms)
 POST /api/session 200 in 192ms (compile: 28ms, proxy.ts: 23ms, render: 140ms)
 GET /api/webhook-config 200 in 93ms (compile: 16ms, proxy.ts: 13ms, render: 63ms)
 GET /api/webhook-config 200 in 53ms (compile: 24ms, proxy.ts: 10ms, render: 19ms)
 POST /api/webhook-config 200 in 206ms (compile: 47ms, proxy.ts: 30ms, render: 129ms)
 GET /api/webhook-config 200 in 112ms (compile: 37ms, proxy.ts: 25ms, render: 50ms)
 POST /api/webhook-config 200 in 145ms (compile: 48ms, proxy.ts: 28ms, render: 69ms)
 GET /api/session/e39060de-e4f9-43b2-9a06-ebfb0b7a04ad/messages 200 in 911ms (compile: 626ms, proxy.ts: 14ms, render: 270ms)
 GET /api/session/02ec3979-ace2-4fb6-89d8-80ed988f0b94/messages 200 in 252ms (compile: 102ms, proxy.ts: 37ms, render: 113ms)
 GET /api/session/9f9e3913-02d0-4d13-8487-de7109b545d3/messages 200 in 320ms (compile: 71ms, proxy.ts: 36ms, render: 213ms)
‚úÖ PostgreSQL tables initialized
 POST /api/session 200 in 220ms (compile: 27ms, proxy.ts: 15ms, render: 178ms)
 POST /api/session 200 in 144ms (compile: 19ms, proxy.ts: 23ms, render: 103ms)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"6fa464f1-a96d-439e-a15b-a33b02527996","role":"user","content":"Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
Saved message for session 6fa464f1-a96d-439e-a15b-a33b02527996: {
  id: '9a5672f7-0d7b-4ecf-b001-3be77b3b7671',
  session_id: '6fa464f1-a96d-439e-a15b-a33b02527996',
  role: 'user',
  content: 'Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:26:21.290Z,
  imageUrl: undefined
}
 POST /api/message 200 in 519ms (compile: 120ms, proxy.ts: 77ms, render: 322ms)
 POST /api/session 200 in 276ms (compile: 102ms, proxy.ts: 62ms, render: 112ms)
 GET /api/webhook-config 200 in 736ms (compile: 159ms, proxy.ts: 85ms, render: 491ms)
 POST /api/session 200 in 714ms (compile: 212ms, proxy.ts: 87ms, render: 415ms)
 POST /api/session 200 in 773ms (compile: 182ms, proxy.ts: 73ms, render: 519ms)
 GET /api/webhook-config 200 in 108ms (compile: 46ms, proxy.ts: 21ms, render: 42ms)
 ‚úì Compiled in 5.7s
 GET /api/session/e39060de-e4f9-43b2-9a06-ebfb0b7a04ad/messages 200 in 1027ms (compile: 582ms, proxy.ts: 110ms, render: 335ms)
 GET /api/session/0219e404-63d7-410e-8003-ab247231a6f2/messages 200 in 237ms (compile: 122ms, proxy.ts: 42ms, render: 73ms)
‚úÖ PostgreSQL tables initialized
 GET /api/session/a09f3a0c-dd11-4538-9400-27a3c1db41c8/messages 200 in 632ms (compile: 133ms, proxy.ts: 14ms, render: 486ms)
‚úÖ PostgreSQL tables initialized
 POST /api/session 200 in 779ms (compile: 93ms, proxy.ts: 175ms, render: 511ms)
 POST /api/session 200 in 373ms (compile: 31ms, proxy.ts: 36ms, render: 306ms)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"09134275-d2a0-4f61-aba8-336ef4633c52","role":"user","content":"Sugira os melhores tipos de vidro para projetos arquitet√¥nicos","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
 POST /api/session 200 in 249ms (compile: 105ms, proxy.ts: 33ms, render: 111ms)
Saved message for session 09134275-d2a0-4f61-aba8-336ef4633c52: {
  id: '9bcde6d4-f041-437c-a73c-f6884a8301e8',
  session_id: '09134275-d2a0-4f61-aba8-336ef4633c52',
  role: 'user',
  content: 'Sugira os melhores tipos de vidro para projetos arquitet√¥nicos',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:28:41.623Z,
  imageUrl: undefined
}
 POST /api/message 200 in 282ms (compile: 38ms, proxy.ts: 21ms, render: 223ms)
 GET /api/webhook-config 200 in 340ms (compile: 55ms, proxy.ts: 24ms, render: 261ms)
 POST /api/session 200 in 124ms (compile: 30ms, proxy.ts: 29ms, render: 65ms)
 POST /api/session 200 in 396ms (compile: 62ms, proxy.ts: 96ms, render: 238ms)
 GET /api/webhook-config 200 in 75ms (compile: 22ms, proxy.ts: 29ms, render: 25ms)
 POST /api/session 200 in 166ms (compile: 19ms, proxy.ts: 13ms, render: 135ms)
 POST /api/session 200 in 227ms (compile: 17ms, proxy.ts: 56ms, render: 154ms)
üì® Broadcasting mensagem: message
POST /api/message payload: {"sessionId":"a72d2678-9412-46f7-8eef-c2e48b09e043","role":"user","content":"Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil","contentType":"text","nome_completo":"Rogger","remote_jid":"41991747318"}
Saved message for session a72d2678-9412-46f7-8eef-c2e48b09e043: {
  id: '03163d9b-de1d-471b-a2a0-409843259a27',
  session_id: 'a72d2678-9412-46f7-8eef-c2e48b09e043',
  role: 'user',
  content: 'Quais s√£o as pr√°ticas mais comuns de sustentabilidade na produ√ß√£o de vidro no Brasil',
  content_type: 'text',
  image_url: null,
  audio_url: null,
  audio_base64: null,
  mime_type: null,
  created_at: 2025-11-28T13:28:52.336Z,
  imageUrl: undefined
}
 POST /api/message 200 in 809ms (compile: 72ms, proxy.ts: 158ms, render: 579ms)
 GET /api/webhook-config 200 in 1173ms (compile: 54ms, proxy.ts: 162ms, render: 957ms)
 POST /api/session 200 in 1120ms (compile: 241ms, proxy.ts: 208ms, render: 671ms)
 GET /api/webhook-config 200 in 1136ms (compile: 61ms, proxy.ts: 923ms, render: 153ms)
 POST /api/session 200 in 2.2s (compile: 132ms, proxy.ts: 60ms, render: 2.0s)
 POST /api/session 200 in 2.2s (compile: 213ms, proxy.ts: 82ms, render: 1939ms)
 GET / 404 in 6.0s (compile: 1407ms, render: 4.6s)
 GET /admin/dashboard 404 in 6.1s (compile: 1929ms, render: 4.2s)
 GET /admin/dashboard 200 in 2.5s (compile: 775ms, render: 1767ms)
 GET / 404 in 3.2s (compile: 1781ms, render: 1419ms)
 GET /admin/dashboard 200 in 6.2s (compile: 3.5s, render: 2.7s)
 GET / 200 in 6.5s (compile: 4.9s, render: 1546ms)
 GET / 200 in 931ms (compile: 47ms, render: 884ms)
 GET / 200 in 2.3s (compile: 60ms, render: 2.2s)
 GET /admin/dashboard 200 in 3.3s (compile: 35ms, render: 3.3s)
 GET / 200 in 3.3s (compile: 695ms, render: 2.6s)
 GET / 200 in 1548ms (compile: 223ms, render: 1325ms)
 GET / 200 in 997ms (compile: 89ms, render: 908ms)
 GET /admin/dashboard 200 in 2.4s (compile: 42ms, render: 2.4s)
 GET / 200 in 2.8s (compile: 56ms, render: 2.7s)
 GET / 200 in 2.7s (compile: 121ms, render: 2.6s)
 GET / 200 in 2.8s (compile: 90ms, render: 2.7s)
 GET /admin/dashboard 200 in 2.8s (compile: 111ms, render: 2.7s)
 GET / 200 in 2.7s (compile: 109ms, render: 2.6s)
 GET / 200 in 2.2s (compile: 80ms, render: 2.2s)
 GET / 200 in 2.3s (compile: 124ms, render: 2.2s)
 GET /admin/dashboard 200 in 2.7s (compile: 40ms, render: 2.7s)
 GET / 200 in 2.8s (compile: 89ms, render: 2.7s)
 GET / 200 in 2.2s (compile: 173ms, render: 2.1s)
 GET / 200 in 1976ms (compile: 101ms, render: 1875ms)
 GET /admin/dashboard 200 in 2.0s (compile: 59ms, render: 1969ms)
 GET / 200 in 1972ms (compile: 91ms, render: 1881ms)
 GET / 200 in 2.1s (compile: 44ms, render: 2.1s)
 GET / 200 in 1993ms (compile: 69ms, render: 1924ms)
 GET /admin/dashboard 200 in 1962ms (compile: 42ms, render: 1920ms)
 GET / 200 in 2.5s (compile: 60ms, render: 2.4s)
 GET / 200 in 1953ms (compile: 28ms, render: 1925ms)
 GET / 200 in 1622ms (compile: 68ms, render: 1554ms)
 GET /admin/dashboard 200 in 1749ms (compile: 75ms, render: 1674ms)
 GET / 200 in 1898ms (compile: 101ms, render: 1797ms)
 GET / 200 in 1663ms (compile: 45ms, render: 1618ms)
 GET /admin/dashboard 200 in 1100ms (compile: 37ms, render: 1062ms)
 GET / 200 in 1147ms (compile: 354ms, render: 793ms)
 GET / 200 in 947ms (compile: 57ms, render: 890ms)
 GET /admin/dashboard 200 in 1009ms (compile: 47ms, render: 962ms)
 GET / 200 in 996ms (compile: 206ms, render: 791ms)
 GET / 200 in 604ms (compile: 79ms, render: 525ms)
 GET / 200 in 340ms (compile: 55ms, render: 285ms)
 GET /admin/dashboard 200 in 1385ms (compile: 30ms, render: 1355ms)
 GET / 200 in 1387ms (compile: 259ms, render: 1128ms)
 GET / 200 in 862ms (compile: 54ms, render: 808ms)
 GET / 200 in 374ms (compile: 52ms, render: 322ms)
 GET / 200 in 681ms (compile: 17ms, render: 663ms)
 GET /admin/dashboard 200 in 693ms (compile: 126ms, render: 567ms)
 GET / 200 in 448ms (compile: 21ms, render: 428ms)
 GET / 200 in 1044ms (compile: 32ms, render: 1012ms)
 GET / 200 in 1501ms (compile: 52ms, render: 1449ms)
 GET /admin/dashboard 200 in 1497ms (compile: 347ms, render: 1149ms)
 GET / 200 in 1881ms (compile: 126ms, render: 1756ms)
 GET / 200 in 1814ms (compile: 56ms, render: 1759ms)
 GET /admin/dashboard 200 in 1650ms (compile: 73ms, render: 1577ms)
 GET / 200 in 1647ms (compile: 548ms, render: 1099ms)
 GET / 200 in 582ms (compile: 95ms, render: 487ms)
 GET / 200 in 304ms (compile: 29ms, render: 275ms)
 GET / 200 in 734ms (compile: 33ms, render: 700ms)
 GET /admin/dashboard 200 in 736ms (compile: 232ms, render: 504ms)
 GET / 200 in 255ms (compile: 26ms, render: 229ms)
 GET / 200 in 175ms (compile: 14ms, render: 161ms)
 GET / 200 in 2.2s (compile: 23ms, render: 2.2s)
 GET /admin/dashboard 200 in 2.2s (compile: 105ms, render: 2.1s)
 ‚úì Compiled in 0ms
 GET / 404 in 6.3s (compile: 3.8s, render: 2.5s)
 GET /admin/dashboard 404 in 5.2s (compile: 3.6s, render: 1559ms)
 GET / 200 in 1291ms (compile: 236ms, render: 1055ms)
 GET /admin/dashboard 200 in 1738ms (compile: 115ms, render: 1622ms)
 GET / 200 in 1418ms (compile: 47ms, render: 1371ms)
 GET / 200 in 1325ms (compile: 84ms, render: 1241ms)
 GET /admin/dashboard 200 in 1078ms (compile: 39ms, render: 1039ms)
 GET / 200 in 1077ms (compile: 243ms, render: 834ms)
 GET / 200 in 875ms (compile: 72ms, render: 803ms)
 GET / 200 in 1266ms (compile: 33ms, render: 1233ms)
 GET /admin/dashboard 200 in 1274ms (compile: 180ms, render: 1093ms)
 GET / 200 in 734ms (compile: 94ms, render: 640ms)
 GET / 200 in 961ms (compile: 28ms, render: 933ms)
 GET / 200 in 1177ms (compile: 66ms, render: 1111ms)
 GET /admin/dashboard 200 in 1178ms (compile: 254ms, render: 924ms)
 GET / 200 in 764ms (compile: 49ms, render: 715ms)
 GET / 200 in 1310ms (compile: 40ms, render: 1270ms)
 GET /admin/dashboard 200 in 2.3s (compile: 197ms, render: 2.1s)
 GET / 200 in 2.3s (compile: 496ms, render: 1773ms)
 GET / 200 in 1688ms (compile: 69ms, render: 1619ms)
 GET / 200 in 1393ms (compile: 37ms, render: 1356ms)
 GET /admin/dashboard 200 in 1006ms (compile: 97ms, render: 909ms)
 GET / 200 in 982ms (compile: 464ms, render: 518ms)
 GET / 200 in 848ms (compile: 42ms, render: 806ms)
 GET / 200 in 1286ms (compile: 48ms, render: 1238ms)
 GET /admin/dashboard 200 in 1291ms (compile: 218ms, render: 1072ms)
 GET / 200 in 773ms (compile: 119ms, render: 654ms)
 GET / 200 in 804ms (compile: 35ms, render: 769ms)
 GET / 200 in 870ms (compile: 58ms, render: 812ms)
 GET /admin/dashboard 200 in 877ms (compile: 234ms, render: 643ms)
 GET / 200 in 457ms (compile: 76ms, render: 381ms)
 GET / 200 in 763ms (compile: 18ms, render: 745ms)
